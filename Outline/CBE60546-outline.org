#+BEGIN_OPTIONS
#+AUTHOR: William F. Schneider
#+TITLE: CBE 60546 Outline
#+EMAIL: wschneider@nd.edu
#+LATEX_CLASS_OPTIONS: [11pt]
#+LATEX_HEADER:\usepackage{geometry}
#+LATEX_HEADER:\geometry{margin=1.0in}
#+LATEX_HEADER:\usepackage{outline}
#+LATEX_HEADER:\usepackage{amsmath}
#+LATEX_HEADER:\usepackage{graphicx}
#+LATEX_HEADER:\usepackage{epstopdf}
#+LATEX_HEADER:\usepackage{fancyhdr}
#+LATEX_HEADER:\usepackage{hyperref}
#+LATEX_HEADER:\usepackage[labelfont=bf]{caption}
#+LATEX_HEADER:\setlength{\headheight}{15.2pt}
#+LATEX_HEADER:\def\dbar{{\mathchar'26\mkern-12mu d}}
#+LATEX_HEADER:\pagestyle{fancy}
#+LATEX_HEADER:\fancyhf{}
#+LATEX_HEADER:\renewcommand{\headrulewidth}{0.5pt}
#+LATEX_HEADER:\renewcommand{\footrulewidth}{0.5pt}
#+LATEX_HEADER:\lfoot{\today}
#+LATEX_HEADER:\cfoot{\copyright\ 2017 W.\ F.\ Schneider}
#+LATEX_HEADER:\rfoot{\thepage}
#+LATEX_HEADER:\lhead{\em{Advanced Chemical Reaction Engineering}}
#+LATEX_HEADER:\rhead{ND CBE 60546}

#+EXPORT_EXCLUDE_TAGS: noexport
#+OPTIONS: toc:nil
#+OPTIONS: H:3 num:3
#+OPTIONS: ':t
#+END_OPTIONS
* Lecture 0: Intro to Reaction Engineering
1. Reaction engineering
#+BEGIN_QUOTE
Understanding, modeling, designing, using, controlling, analyzing, improving anything in which chemical reactions happen.
#+END_QUOTE
1. Reaction engineering applications
   1. Traditional
      1. Industrial chemical/petroleum processes
      2. Fine chemical/pharmaceutical processes
      3. Emerging, eg biorefinergy, shale gas, [[http://cistar.us]]
   2. Energy storage, batteries, fuel cells
   3. Environmental systems
      1. Atmosphere, lake, bioreactor (water purification), catalytic convertor
   4. Biological systems
      1. Cell, organ, body
   5. Laboratory reactors - interrogate, quantify
   6. Research - improved materials (catalysts), improved processes, understand limitations
      1. Sabatier plot, [[https://doi.org/10.1038/nchem.121]]
2. Course structure
   1. Quantifying chemical reactions
      1. Stoichiometry
      2. Thermodynamics - heat flow, direction, equilibrium
      3. Kinetics - rates, mechanisms
   2. Physical/chemical interactions
      1. Transport, mixing, diffusion resistance, ...
   3. Chemical reactors
      1. Ideal 0 and 1-dimensional
      2. Non-ideal
      3. Non-isothermal
      4. Non-steady state
      5. Multiphase
   4. Chemical processes (beyond us)
   5. Markets (beyond us)

* Stoichiometry and reactions
1. Substances
2. Amounts
   1. mass, moles, volumes
   2. flow rates
3. compositions
   1. amount/total amount
4. Reactions and stoichiometric coefficients
   1. Advancements \(n_j = \sum_i \nu_{ij} \xi_i \)
   2. Limiting reagents 
* Chemical thermodynamics and equilibria
1. Chemical reactions \( \sum_j \nu_j A_j = 0 \)
2. Thermodynamic potential differences
   1. Standard states
   2. Formation reactions
   3. Reaction enthalpy $\Delta H^\circ (T) = \sum_j \vu_j H^\circ_j (T) = \sum_j \nu_j H^\circ_{f,j}(T)$
   4. Reaction entropy $\Delta S^\circ (T) =  \sum_j \vu_j S^\circ_j (T)$
3. Equilibrium-closed system
   1. Free energy vs reaction advancement, \(G(\xi,T) = \sum_j n_j\mu_j = \sum_j \left (n_{j0} + \nu_j \xi \right ) \left (\mu_j^\circ(T) + RT \ln a(\xi,T) \right ) \)
   2. Equilibrium \( (\partial G / \partial \xi)_{T,P} = 0 \)
   3. Equilibrium constants and algebraic solutions
   4. Multiple reactions
4. Le'Chatlier principle - system at equilibrium responds to oppose any perturbation
   1. Pressure, composition
   2. Temperature: Gibbs-Helmholtz and van't Hoff
5. Equilibrium-open system
   1. Reaction phase diagrams, see [[http://pubs.acs.org/doi/abs/10.1021/jacs.6b02651]] for an example
   2. Electrochemical reactions
6. The molecular interpretation
7. Non-ideal activities
8. Surface adsorption
   1. Langmuir


** Non-equilibrium thermodynamics :noexport:
#+BEGIN_EXPORT LaTeX
\begin{table}
\begin{center}
\caption{Physical units}
\begin{tabular}{|lrlrl|}
  \hline
  $N_\mathrm{Av}$: & $6.02214 \times 10^{23}$& mol$^{-1}$  & & \\
  1 amu: & $1.6605\times 10^{-27}$ & kg & & \\
  $k_\mathrm{B}$: & $1.38065\times 10^{-23}$ & J~K$^{-1}$ & $8.61734\times
  10^{-5}$ & eV K$^{-1}$\\
  $R$: & 8.314472 & J K$^{-1}$ mol$^{-1}$ & $8.2057 \times 10^{-2}$ & l atm mol$^{-1}$ K$^{-1}$\\
  $\sigma_\mathrm{SB}$: & $5.6704\times 10^{-8}$ & J s$^{-1}$ m$^{-2}$ K$^{-4}$ & & \\
  $c$: & $2.99792458\times 10^8$ & m s$^{-1}$ & & \\
  $h$: & $6.62607\times 10^{-34}$ & J s & $4.13566\times 10^{-15}$ & eV s
  \\
  $\hbar$: & $1.05457\times 10^{-34}$ & J s & $6.58212\times 10^{-16}$&  eV s \\
  $hc$: & 1239.8 & eV nm  & & \\
  $e$: & $1.60218\times 10^{-19}$ &  C & & \\
  $m_e:$ & $9.10938215\times 10^{-31}$ & kg &0.5109989 & MeV c$^{-2}$  \\
  $\epsilon_0$: & $8.85419 \times 10^{-12}$ & C$^2$ J$^{-1}$ m$^{-1}$ & $5.52635\times
  10^{-3}$ & $e^2$ \AA$^{-1}$ eV$^{-1}$ \\
  $e^2/4\pi\epsilon_0$: & $2.30708 \times 10^{-28}$&  J m & 14.39964 & eV \AA\\
  $a_0$: & $0.529177 \times 10^{-10}$ & m & 0.529177 & \AA\\
  $E_\mathrm{H} $: & 1 & Ha & 27.212 & eV \\
  \hline
\end{tabular}
\end{center}
\end{table}
#+END_EXPORT



* Empirical kinetics
1. rates
2. reactor mass balance
3. rate expressions
4. rate orders
5. apparent orders
6. integrated rate expressions
7. temperature and Arrhenius expression

#+BEGIN_SRC python
import numpy as np               #this lets up handles arrays of data
import matplotlib.pyplot as plt
from scipy.integrate import odeint, solve_ivp

def dCdt(C,t,k):
    dC_Adt = -k*C[0]*C[1]     # A + B -> C;  r = k CA CB
    dC_Bdt = -k*C[0]*C[1]
    dC_Cdt =  k*C[0]*C[1]
    dCdt = [dC_Adt,dC_Bdt,dC_Cdt] 
    return dCdt

# initialize concentrations
C_0 = [1., 1.5, 0.]

# initialize k's
k = 2.

# Range of time to solve over
t = np.arange(0,10,0.1) 
t_span = (0., 10.)

p = (k,) # turn parameters into a tuple
# Solve two ODEs with odeint
#C = solve_ivp(dCdt,t_span,C_0,p,method='LSODA')
C = odeint(dCdt,C_0,t,p)

C_A = C.transpose()[0] # Get C_A from C
C_B = C.transpose()[1] # Get C_B from C
C_C = C.transpose()[2]
plt.figure()
plt.plot(t,C_A,'-',label=r'$C_{\rm A}$')
plt.plot(t,C_B,'-',label=r'$C_{\rm B}$')
plt.plot(t,C_C,'-',label=r'$C_{\rm C}$')
plt.xlabel('Time (s)')
plt.ylabel('Concentration (mol/L)')
plt.legend()
plt.savefig('./conc.png')
#+END_SRC

#+RESULTS:

[[./conc.png]]
#+RESULTS:

* Analyzing reactor data
1. Differential methods
   1. Measuring rates
2. Integral methods
3. Half-lives


#+BEGIN_SRC python
import numpy as np               #this lets up handles arrays of data
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def differential(x, k, alpha):
    return k*x**alpha

def integral(t, a, b):
    return (2*a/(2+a*b*t))**2

t = np.array([0.00, 2.25, 4.50, 6.33, 8.00, 10.25, 12.00, 13.50, 15.60, 17.85, 19.60, 27.00, 30.00, 38.00, 41.00, 45.00, 47.00, 57.00, 63.00])

C_Br2 = np.array([0.3335, 0.2965, 0.2660, 0.2450, 0.2255, 0.2050, 0.1910, 0.1794, 0.1632, 0.1500, 0.1429, 0.1160, 0.1053, 0.0830, 0.0767, 0.0705, 0.0678, 0.0553, 0.0482])

plt.figure()
plt.plot(t,C_Br2,'o')
plt.xlabel('Time (s)')
plt.ylabel('Concentration (mol/L)')
plt.legend()
plt.savefig('./xylene-conc.png')

delta_t = np.ediff1d(t)        # finite difference between adjacent points
delta_C = np.ediff1d(C_Br2)

grad_t = np.gradient(t)            # second order approximation to gradient, allowing for unequal step size
grad_C = np.gradient(C_Br2)
rate = -np.divide(grad_C,grad_t)

plt.figure()
plt.plot(C_Br2,rate,'o')
plt.xlabel('Concentration (mol/L)')
plt.ylabel('Rate (mol/L/x)')
plt.legend()

popt, pcov = curve_fit(differential, C_Br2, rate )

print('k = {0:f}, alpha={1:f}'.format(popt[0],popt[1]))

model = differential(C_Br2,popt[0],popt[1])
plt.plot(C_Br2,model,'-')

plt.savefig('./xylene-rate.png')

difference_array = np. subtract(rate, model)
squared_array = np. square(difference_array)
mse = squared_array. mean()
print(mse)

# Suggests order of 1.5
popt1, pcov1 = curve_fit(integral, t, C_Br2)
print('k = {0:f}'.format(popt[1]))

model1 = integral(t, popt1[0], popt1[1])

plt.figure()
plt.plot(t,C_Br2,'o')
plt.plot(t,model1,'-')
plt.xlabel('Time (s)')
plt.ylabel('Concentration (mol/L)')
plt.legend()
plt.savefig('./xylene-int-model.png')


#+END_SRC

#+RESULTS:
: k = 0.085277, alpha=1.450860
: 2.4942019231742367e-07
: k = 1.450860


#+BEGIN_SRC python  

#+END_SRC

[[./xylene-conc.png]]
[[./xylene-rate.png]]
[[./xylene-int-model.png]]
#+RESULTS:

* Molecular basis
1. reaction pathway, detailed balance
2. bimolecular, collision theory, TST
3. unimolecular reactions

* Mechanisms
1. simple reaction network
2. free energy surface
3. QSSA
4. Pre-equilibrium
5. Selectivity
6. Rate control

* Heterogeneous reactions
1. adsorption, L-H
2. TPD
3. catalysis
4. Sabatier analysis

* Liquid-phase reactions

#+BEGIN_EXPORT LaTeX
 \begin{table}
 \begin{center}
     \caption{\large{Equilibrium and Rate Constants}}
    \begin{description}
    \item[Equilibrium Constants] $a~\text{A} + b~\text{B} \rightleftharpoons c~\text{C} + d~\text{D} $
      \begin{eqnarray*}
        K_{eq}(T) &=& e^{\Delta S^\circ(T,V)/k_B}e^{-\Delta H^\circ(T,V)/k_BT}
        \\ \\
             K_c(T) &=&
            \left(\frac{1}{c^\circ}\right)^{\nu_c+\nu_d-\nu_a-\nu_b}\frac{(q_c/V)^{\nu_c}(q_d/V)^{\nu_d}}{(q_a/V)^{\nu_a}(q_b/V)^{\nu_b}}e^{-\Delta
             E(0)\beta}\\ \\
             K_p(T) &=&
           \left(\frac{k_BT}{P^\circ}\right)^{\nu_c+\nu_d-\nu_a-\nu_b}\frac{(q_c/V)^{\nu_c}(q_d/V)^{\nu_d}}{(q_a/V)^{\nu_a}(q_b/V)^{\nu_b}}e^{-\Delta
             E(0)\beta}
 \end{eqnarray*}
 \item[Unimolecular Reaction] $\text[A] \rightleftharpoons [\text{A} ]^\ddagger
   \rightarrow C$
       \begin{displaymath}
         k(T)=\nu^\ddagger \bar K^\ddagger=\frac{k_B T}{h} \frac{\bar{q}_\ddagger(T)/V}{q_A(T)/V}
           e^{-\Delta E^\ddagger(0)\beta}
       \end{displaymath}
 \begin{center}
       \begin{tabular}{cc}
       $ \displaystyle E_a =\Delta H^{\circ\ddagger}+k_B T $
       & $ \displaystyle A = e^1\frac{k_B T}{h} e^{\Delta S^{\circ\ddagger}} $
       \end{tabular}
 \end{center}
 \item[Bimolecular Reaction] $
         \mathrm{A} + \mathrm{B} \rightleftharpoons [ \mathrm{AB}]^\ddagger
         \rightarrow \text{C}$
       \begin{displaymath}
         k(T)=\nu^\ddagger \bar K^\ddagger=\frac{k_B T}{h} \frac{q_\ddagger(T)/V}{(q_A(T)/V)(q_B(T)/V)}\left
           (\frac{1}{c^\circ}\right )^{-1}
         e^{-\Delta E^\ddagger(0)\beta}
       \end{displaymath}
       \begin{center}
         \begin{tabular}{cc}
         $ \displaystyle E_a  =\Delta H^{\circ\ddagger}+2 k_B T $ & $ \displaystyle
         A  = e^2\frac{k_B T}{h} e^{\Delta S^{\circ\ddagger}} $
       \end{tabular}
       \end{center}
    \end{description}
  \end{center}
  \end{table}
#+END_EXPORT
